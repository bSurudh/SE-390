<DOCTYPE html>
<html>
    <head>
        <title>My Pictures</title>
        <!-- Bootstrap Core CSS -->
        <link href="css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="css/landing-page.css" rel="stylesheet">

        <!-- Custom Fonts -->
        <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

        <!--<script type="text/javascript">
            if(document.cookie.indexOf('id_token') == -1) {
                window.location = "https://bsurudh.github.io";
            }
        </script>-->
    </head>

    <body>
    <script src="js/jquery.js"></script>
    <script>
      function getCookie(cname) {
        var name = cname + "=";
        var ca = document.cookie.split(';');
        for(var i = 0; i <ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') {
                c = c.substring(1);
            }
            if (c.indexOf(name) == 0) {
                return c.substring(name.length,c.length);
            }
        }
        return "";
      }
      
      var imagesURL = "https://geopix-bengineering.rhcloud.com/images/user";
      var userID = getCookie("id_token");
      var photos = "";
      var picturesTable = document.getElementById("picturesTable")
      jQuery.ajax({
            url: imagesURL,
            type: "GET",
            dataType: "JSON",
            beforeSend: function(xhr) {
                xhr.setRequestHeader("authorization", "Bearer: " + userID);
            },
            success: function(data) {
                console.log(JSON.parse(JSON.stringify(data)));
                var baseURL = "https://geopix-bengineering.rhcloud.com/images/";
                // work with json data to create features
                for(var i = 0; i < data.length; i++) {
                    var curImage = data[i];
                    if(!curImage.hasOwnProperty("rating") || !curImage.hasOwnProperty("_id") || !curImage.hasOwnProperty("timestamp")) {
                        continue;
                    }
                    var imageRating = currImage["rating"];
                    var imageId = currImage["_id"];
                    var imageDate = new Date(currImage["timestamp"]);
                    var dateDisplayStr = imageDate.toDateString() + " " + imageDate.toLocaleTimeString();
                    var newRow = picturesTable.insertRow(0);
                    var pictureCell = newRow.insertCell(0);
                    var timestampCell = newRow.insertCell(1);
                    var ratingCell = newRow.insertCell(2);
                    var buttonCell = newRow.insertCell(3);
                    var pictureImage = new Image(150, 200);
                    pictureImage.src = baseURL + imageId;
                    pictureCell.innerHTML = pictureImage;
                    timestampCell.innerHTML = dateDisplayStr;
                    ratingCell.innerHTML = imageRating;
                    buttonCell.innerHTML = '<button type="button" class="btn btn-primary">Delete</button>';
                }
            },
            error: function(e,t) {
                console.log("AJAX friends request failed: " + t + " " + e);
            }
        });
    </script>
        <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top topnav" role="navigation">
        <div class="container topnav">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand topnav" href="/index.html">GeoPix</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/map.html">Map</a>
                    </li>
                    <li>
                        <a href="/addfriends.html">Add Friends</a>
                    </li>
                    <li>
                        <a href="/mypictures.html">My Pictures</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <div class="container">
      <h2>.</h2>    
      <h2>My Pictures</h2>
      <table class="table table-hover" id="picturesTable">
        <thead>
          <tr>
            <th>Picture</th>
            <th>Timestamp</th>
            <th>Rating</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
            <tr>
              <td style="vertical-align: middle;">
                <img src='http://vignette2.wikia.nocookie.net/pokemon/images/b/b1/025Pikachu_XY_anime_3.png' style="width: 150px; height: 200px">
              </td>
              <td style="vertical-align: middle;">June 4, 2016</td>
              <td style="vertical-align: middle;">3.8</td>
              <td style="vertical-align: middle;"><button type="button" class="btn btn-primary">Delete</button></td>
            </tr>
        </tbody>
    </div>
    </body>
</html>
>
</html>
